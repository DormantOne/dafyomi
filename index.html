<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Daf Yomi Test</title>
</head>
<body>
    <h3 id="currentDate"></h3>
    <h3 id="currentDaf"></h3>
    <div id="hebrewText"></div>
    <button id="fetchDaf">Fetch Daf</button>

    <script>
        async function fetchDafHandler() {
            const currentDateDiv = document.getElementById("currentDate");
            const currentDafDiv = document.getElementById("currentDaf");
            const hebrewTextDiv = document.getElementById("hebrewText");

            // Generate date in M/D/YYYY format
            const date = new Date("2025-01-01"); // Test with known date; change to new Date() for current date
            const month = date.getMonth() + 1;
            const day = date.getDate();
            const year = date.getFullYear();
            const today = `${month}/${day}/${year}`; // e.g., "1/1/2025"

            console.log("Generated today:", today);
            currentDateDiv.textContent = `Today's Date: ${today}`;

            try {
                const response = await fetch("Daf_Yomi_Cycle.json");
                if (!response.ok) {
                    console.error("Failed to load JSON:", response.status);
                    throw new Error("Failed to load JSON");
                }
                const dafYomiData = await response.json();
                console.log("JSON loaded:", dafYomiData);
                console.log("Available keys:", Object.keys(dafYomiData));

                // Check if the key exists
                if (today in dafYomiData) {
                    console.log("Key exists, assignment:", dafYomiData[today]);
                    currentDafDiv.textContent = `Daf Yomi: ${dafYomiData[today]}`;
                    console.log("Updated currentDafDiv to:", currentDafDiv.textContent);
                } else {
                    console.log("Key does not exist");
                    currentDafDiv.textContent = "No Daf Yomi assigned for today.";
                    hebrewTextDiv.textContent = "No content available.";
                }
            } catch (error) {
                console.error("Error:", error);
                hebrewTextDiv.textContent = "Error fetching Daf.";
            }
        }

        // Prevent multiple event listeners
        const fetchDafButton = document.getElementById("fetchDaf");
        fetchDafButton.removeEventListener("click", fetchDafHandler); // Remove any existing
        fetchDafButton.addEventListener("click", fetchDafHandler);
    </script>
</body>
</html>
